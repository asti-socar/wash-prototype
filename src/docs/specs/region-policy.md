# 지역 정책 관리

## 1. 개요
- **화면명**: 지역 정책 관리
- **목적**: 시/도(Region1) 및 시군구(Region2) 단위의 공통 세차 정책을 설정. 존에 개별 정책이 없으면 해당 지역 정책이 기본값으로 적용.
- **주요 기능**: 지역1/지역2 정책 탭 분리 조회, 인라인 수정

## 2. 데이터

### 2.1 Mock 데이터
| 파일 | 건수 | 설명 |
| :--- | :---: | :--- |
| `region1policy.json` | 17건 | 시/도 단위 정책 (전체 시도) |
| `region2policy.json` | 60건 | 시군구 단위 정책 |

### 2.2 지역1 정책 데이터 구조
| 필드명 | 타입 | 설명 | 예시 |
| :--- | :---: | :--- | :--- |
| Region1ID | string | 지역1 고유 식별자 | "R1-01" |
| 시도 | string | 시/도 명칭 | "서울" |
| 주기세차(일) | number | 주기세차 오더 발행 기준 일수 | 14 |
| 라이트세차 | string | 라이트세차 적용 여부 (Y/N) | "Y" |

### 2.3 지역2 정책 데이터 구조
| 필드명 | 타입 | 설명 | 예시 |
| :--- | :---: | :--- | :--- |
| Region2ID | string | 지역2 고유 식별자 | "R2-001" |
| 시도 | string | 소속 시/도 명칭 | "충남" |
| 시군구 | string | 시군구 명칭 | "공주시" |
| 주기세차(일) | number | 주기세차 오더 발행 기준 일수 | 15 |
| 라이트세차 | string | 라이트세차 적용 여부 (Y/N) | "Y" |

---

## 3. 화면 구성 및 기능

### 3.1 탭 구성
| 탭 | value | 설명 |
| :--- | :--- | :--- |
| 지역1 정책(시도) | `region1` | 시/도 단위 정책 목록 (기본 탭) |
| 지역2 정책(시군구) | `region2` | 시군구 단위 정책 목록 |

- 탭 전환 시 각 탭의 상태(수정 모드, 필터, 정렬 등)는 독립적으로 유지

---

### 3.2 지역1 정책(시도) 탭

#### 3.2.1 목록 조회
- 페이지네이션 없이 전체 17건 노출
- 기본 정렬: 없음 (Mock 데이터 순서 유지)

#### 3.2.2 컬럼
| 헤더명 | key | 정렬 | 수정 모드 | 비고 |
| :--- | :--- | :---: | :--- | :--- |
| ID | Region1ID | | 텍스트 (읽기 전용) | |
| 시도 | 시도 | | 텍스트 (읽기 전용) | |
| 주기세차(일) | 주기세차(일) | O | `<Input type="number">` (w-24) | |
| 라이트세차 | 라이트세차 | | `<Select>` Y/N (w-20) | 읽기 모드: Badge (Y=ok, N=default) |

#### 3.2.3 정렬
- **정렬 가능 컬럼**: 주기세차(일) 1개만
- 헤더 클릭 시 오름차순/내림차순 토글
- 정렬 가능 컬럼은 헤더에 화살표 아이콘(↕)으로 표시
- 초기 상태: 정렬 없음 (`sortConfig.key = null`)

#### 3.2.4 인라인 수정
- **[수정] 버튼**: 우측 상단, variant="outline". 클릭 시 전체 행의 수정 가능 필드가 Input/Select로 전환
- **[저장] 버튼**: 수정된 전체 데이터를 반영 후 읽기 모드로 복귀
- **[취소] 버튼**: variant="secondary". 변경 사항을 파기하고 초기 데이터로 복원 후 읽기 모드로 복귀
- 수정 모드에서는 [저장], [취소] 두 버튼이 나란히 표시

#### 3.2.5 상태 관리
```
editedData: 전체 데이터 복사본 (수정 시 이 상태를 변경)
isEditMode: 수정 모드 여부 (boolean)
sortConfig: { key, direction } — 현재 정렬 상태
```
- 취소 시 `editedData`를 `initialRegion1Data`로 초기화

---

### 3.3 지역2 정책(시군구) 탭

#### 3.3.1 필터/검색
| 구분 | 컴포넌트 | 위치 | 설명 |
| :--- | :--- | :--- | :--- |
| 시도 필터 | `<Select>` (w-32) | 좌측 | 기본값 "전체 시도". 선택 시 해당 시도의 시군구만 표시 |
| 시군구 검색 | `<Input>` (w-64) | 시도 필터 우측 | placeholder: "시군구 검색 (쉼표/공백으로 구분)" |

- **시도 필터 옵션**: "전체 시도" + Mock 데이터의 고유 시도 목록 (Set으로 중복 제거)
- **시군구 검색 로직**: 입력값을 콤마(`,`) 또는 공백으로 분리하여 복수 검색어 생성. OR 조건으로 `시군구.includes(term)` 매칭
- 시도 필터와 검색은 AND 조건으로 동시 적용

#### 3.3.2 컬럼
| 헤더명 | key | 정렬 | 수정 모드 | 비고 |
| :--- | :--- | :---: | :--- | :--- |
| ID | Region2ID | | 텍스트 (읽기 전용) | |
| 시도 | 시도 | | 텍스트 (읽기 전용) | |
| 시군구 | 시군구 | | 텍스트 (읽기 전용) | |
| 주기세차(일) | 주기세차(일) | O | `<Input type="number">` (w-24) | |
| 라이트세차 | 라이트세차 | | `<Select>` Y/N (w-20) | 읽기 모드: Badge (Y=ok, N=default) |

#### 3.3.3 정렬
- **정렬 가능 컬럼**: 주기세차(일) 1개만
- 동작 방식은 지역1 탭과 동일

#### 3.3.4 페이지네이션
- **페이지 크기**: 100건
- `usePagination(sortedRows, 100)` 사용
- 필터/검색/정렬 적용 후 데이터에 대해 페이지네이션 수행
- 필터 변경 시 페이지는 자동 리셋되지 않음 (usePagination 내부 동작에 의존)

#### 3.3.5 인라인 수정
- 동작 방식은 지역1 탭과 동일 (수정/저장/취소 버튼)
- **수정 버튼 위치**: 필터/검색 영역 우측 (flex justify-between으로 배치)
- **필터 연동**: 수정은 `editedData2` 전체에 대해 수행하므로, 필터 상태에서 수정 시 화면에 보이지 않는 데이터의 유실 없음
  - 필터링된 행만 화면에 표시되지만, 수정 시 `Region2ID`로 전체 데이터에서 해당 행을 찾아 업데이트
  - 저장 시 필터/검색 상태와 무관하게 전체 데이터 반영

#### 3.3.6 상태 관리
```
editedData2: 전체 데이터 복사본
isEditMode2: 수정 모드 여부
filterSido: 시도 필터 값 ("all" | 시도명)
searchSigungu: 시군구 검색어
sortConfig2: { key, direction }
```

---

## 4. 데이터 처리 흐름

### 4.1 지역2 필터링·정렬·페이지네이션 순서
```
editedData2 (전체 60건)
  → filterSido 적용 (시도 필터)
  → searchSigungu 적용 (시군구 검색, OR 조건)
  → filteredRows
  → sortConfig2 적용 (주기세차(일) 정렬)
  → sortedRows
  → usePagination (100건 단위)
  → currentData (화면 표시)
```

### 4.2 수정 데이터 흐름
```
[수정] 클릭 → isEditMode = true → 컬럼 render가 Input/Select로 전환
  → 사용자 값 변경 → handleUpdateData(regionId, field, value)
  → editedData에서 regionId로 행 매칭 → 해당 필드만 업데이트
  → [저장] → console.log + 읽기 모드 복귀
  → [취소] → editedData를 initialData로 리셋 + 읽기 모드 복귀
```

---

## 5. UI 컴포넌트 의존성
| 컴포넌트 | 용도 |
| :--- | :--- |
| Tabs / TabsList / TabsTrigger / TabsContent | 지역1/지역2 탭 전환 |
| DataTable | 테이블 렌더링 (정렬 지원) |
| Badge | 라이트세차 Y/N 표시 (tone: ok/default) |
| Button | 수정/저장/취소 버튼 |
| Input | 주기세차(일) 인라인 편집, 시군구 검색 |
| Select | 라이트세차 인라인 편집, 시도 필터 |
| Pagination / usePagination | 지역2 탭 페이지네이션 |

## 6. Badge 색상 규칙
| 값 | tone | 색상 |
| :--- | :--- | :--- |
| Y | ok | 녹색 (emerald) |
| N | default | 회색 (slate) |
