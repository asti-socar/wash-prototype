# 세차 인터널 어드민 - 대시보드 기능 명세서

## 1. 개요

### 1.1 문서 정보
| 항목 | 내용 |
|------|------|
| 문서명 | 세차 인터널 어드민 대시보드 기능 명세서 |
| 버전 | 2.0 |
| 작성일 | 2026-02-04 |
| 작성자 | ASTI (PM) |

### 1.2 화면 목적
1. **실시간 현황 모니터링**: 전체 세차 예약 현황이 정상인지, 긴급 개입이 필요한 상황인지 즉시 판단
2. **리스크 오더 관리**: 파트너사 승인 지연으로 세차가 시작되지 못하는 상황을 사전 감지하여 알림 발송 또는 매니저 권한으로 직접 개입(강제 승인/조정)
3. **파트너 성과 모니터링**: 파트너별 오더 현황 및 성과 지표 추적

### 1.3 사용자 시나리오
- **하루 시작 시**: 전체 현황 체크, 전일 대비 이상 징후 확인
- **업무 중 상시**: 실시간 모니터링, 리스크 오더 즉시 대응
- **파트너 관리**: 파트너별 성과 지표 확인 및 문제 파트너 조치

### 1.4 화면 구조
```
┌─────────────────────────────────────────────────────────────┐
│  헤더: 대시보드 타이틀 + 마지막 갱신 시간 + 새로고침 버튼      │
├─────────────────────────────────────────────────────────────┤
│  [1] 오더 현황 영역                                          │
│      좌: 도넛 차트 + 범례  |  우: 4개 상태 카드               │
├─────────────────────────────────────────────────────────────┤
│  [2] 리스크 관리 영역                                        │
│      좌: 도넛 차트 + 범례  |  우: 탭별 4개 상태 카드          │
├─────────────────────────────────────────────────────────────┤
│  [3] 파트너 수행 관리 영역                                    │
│      파트너별 성과 테이블 (담당, 대기, 수행중, 적시율 등)      │
├─────────────────────────────────────────────────────────────┤
│  [4] 시계열 트렌드 그래프 영역                                │
│      A: 일자별 정규 오더 생성량  |  B: 일별 리스크 추이        │
└─────────────────────────────────────────────────────────────┘
```

---

## 2. 공통 사항

### 2.1 데이터 갱신
| 항목 | 설명 |
|------|------|
| 갱신 방식 | 수동 (새로고침 버튼 클릭 시) |
| 조회 기준일 | 오늘 (고정) |

### 2.2 헤더 영역
| 요소 | 설명 |
|------|------|
| 타이틀 | "세차 운영 대시보드" |
| 서브타이틀 | "실시간 현황 모니터링 및 리스크 관리" |
| 갱신 시간 | "마지막 갱신: N초 전" 또는 "N분 전" 형태로 표시 |
| 새로고침 버튼 | RefreshCw 아이콘 + "새로고침" 텍스트, 클릭 시 전체 데이터 즉시 갱신 |

### 2.3 색상 팔레트 (쿨 톤 + 80% 투명도)
| 색상명 | HEX | RGBA (80%) | 용도 |
|--------|-----|------------|------|
| Steel Blue | #7BA3C9 | rgba(123, 163, 201, 0.8) | 수행 대기, 초장기미세차 |
| Warm Beige | #E8C47C | rgba(232, 196, 124, 0.8) | 수행 중, ML긴급 |
| Soft Teal | #7BC9A8 | rgba(123, 201, 168, 0.8) | 완료 |
| Dusty Rose | #D98E8E | rgba(217, 142, 142, 0.8) | 취소, 위생장애 |

> **참고**: 차트 색상은 80% 투명도 적용, 카드 숫자 및 범례는 100% 색상 유지

---

## 3. [영역 1] 오더 현황

### 3.1 개요
전체 오더의 상태별 분포를 도넛 차트와 카드로 시각화하여 현재 운영 상황을 한눈에 파악

### 3.2 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│  오더 현황                                                   │
│  전체 오더의 상태별 현황                                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐  ┌─────┬─────┬─────┬─────┐               │
│  │   도넛 차트   │  │수행 │수행 │     │     │               │
│  │     103      │  │대기 │ 중  │완료 │취소 │               │
│  │     전체     │  │     │     │     │     │               │
│  └──────────────┘  └─────┴─────┴─────┴─────┘               │
│  ● 수행대기: 28                                              │
│  ● 수행중: 12                                                │
│  ● 완료: 52                                                  │
│  ● 취소: 11                                                  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 도넛 차트

#### 3.3.1 구성
전체 오더를 아래 4개 상태로 분류하여 비율 표시

| 상태 | 색상 | 설명 |
|------|------|------|
| 수행 대기 | rgba(123, 163, 201, 0.8) | 발행 + 예약 상태 합산 |
| 수행 중 | rgba(232, 196, 124, 0.8) | 현재 수행 중인 오더 |
| 완료 | rgba(123, 201, 168, 0.8) | 수행 완료된 오더 |
| 취소 | rgba(217, 142, 142, 0.8) | 취소된 오더 |

#### 3.3.2 표시 정보
- 차트 중앙: 전체 오더 수 + "전체" 라벨
- 차트 크기: 160px × 160px
- innerRadius: 45, outerRadius: 70
- paddingAngle: 2

#### 3.3.3 범례
차트 우측에 세로로 배치
- 형식: `● 상태명: 건수`
- 클릭 시 해당 상태로 필터링된 오더 목록으로 이동

### 3.4 상태 카드 (4개)

#### 3.4.1 수행 대기 카드
| 항목 | 내용 |
|------|------|
| 메인 수치 | 발행 + 예약 합계 |
| 색상 | #7BA3C9 (Steel Blue) |
| 하위 항목 | 발행: N건, 예약: N건 |
| 클릭 동작 | 각 하위 항목 클릭 시 해당 상태 필터 |

#### 3.4.2 수행 중 카드
| 항목 | 내용 |
|------|------|
| 메인 수치 | 수행 중 건수 |
| 색상 | #E8C47C (Warm Beige) |
| 클릭 동작 | 수행 중 상태 필터 |

#### 3.4.3 완료 카드
| 항목 | 내용 |
|------|------|
| 메인 수치 | 완료 건수 |
| 색상 | #7BC9A8 (Soft Teal) |
| 하위 항목 | 적시수행: N건 (#7BC9A8), 지연수행: N건 (#D98E8E) |
| 클릭 동작 | 완료 상태 필터 |

#### 3.4.4 취소 카드
| 항목 | 내용 |
|------|------|
| 메인 수치 | 취소 건수 |
| 색상 | #D98E8E (Dusty Rose) |
| 하위 항목 | 변경, 미예약, 노쇼, 수행원, 우천 (각 취소 유형별 건수) |
| 클릭 동작 | 각 취소 유형 클릭 시 해당 cancelType 필터 |

### 3.5 인터랙션 매핑
| 클릭 요소 | goOrdersWithFilter 파라미터 |
|----------|---------------------------|
| 도넛 세그먼트 (수행 대기) | `{}` |
| 도넛 세그먼트 (수행 중) | `{ status: "수행 중" }` |
| 도넛 세그먼트 (완료) | `{ status: "완료" }` |
| 도넛 세그먼트 (취소) | `{ status: "취소" }` |
| 발행 | `{ status: "발행" }` |
| 예약 | `{ status: "예약" }` |
| 변경취소 | `{ status: "취소", cancelType: "변경취소" }` |
| 미예약취소 | `{ status: "취소", cancelType: "미예약취소" }` |
| 노쇼취소 | `{ status: "취소", cancelType: "노쇼취소" }` |
| 수행원취소 | `{ status: "취소", cancelType: "수행원취소" }` |
| 우천취소 | `{ status: "취소", cancelType: "우천취소" }` |

---

## 4. [영역 2] 리스크 관리

### 4.1 개요
리스크 유형별(위생장애, 고객피드백(ML)_긴급, 초장기미세차) 오더 현황을 탭으로 구분하여 상세 모니터링

### 4.2 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│  리스크 관리                                                 │
│  리스크 유형별 오더 현황 모니터링                              │
├─────────────────────────────────────────────────────────────┤
│  [위생장애 (3)] [고객피드백(ML)_긴급 (5)] [초장기미세차 (4)]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────┐  ┌─────┬─────┬─────┬─────┐               │
│  │   도넛 차트   │  │수행 │수행 │     │     │               │
│  │      12      │  │대기 │ 중  │완료 │취소 │               │
│  │    리스크    │  │     │     │     │     │               │
│  └──────────────┘  └─────┴─────┴─────┴─────┘               │
│  ● 위생장애: 3                                               │
│  ● ML긴급: 5                                                 │
│  ● 초장기미세차: 4                                            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 4.3 탭 구성

#### 4.3.1 탭 헤더
| 탭명 | 필터 조건 (orderType) | 배지 표시 |
|------|----------------------|----------|
| 위생장애 | "위생장애" | 해당 유형 전체 건수 |
| 고객피드백(ML)_긴급 | "고객 피드백(ML)_긴급" | 해당 유형 전체 건수 |
| 초장기미세차 | "초장기 미세차" | 해당 유형 전체 건수 |

#### 4.3.2 탭 스타일
- 선택된 탭: 파란색 텍스트 (#0052CC), 하단 파란색 언더라인, 배지 파란색 배경
- 미선택 탭: 회색 텍스트 (#6B778C), 배지 회색 배경

### 4.4 리스크 도넛 차트

#### 4.4.1 구성
리스크 유형별 오더 비율만 표시 (일반 오더 제외)

| 유형 | 색상 |
|------|------|
| 위생장애 | rgba(217, 142, 142, 0.8) |
| ML긴급 | rgba(232, 196, 124, 0.8) |
| 초장기미세차 | rgba(123, 163, 201, 0.8) |

#### 4.4.2 표시 정보
- 차트 중앙: 리스크 총합 + "리스크" 라벨
- 범례: 차트 우측에 세로로 배치

### 4.5 탭별 상태 카드

선택된 탭의 리스크 유형에 해당하는 오더들의 상태별 현황 표시

| 카드 | 표시 내용 |
|------|----------|
| 수행 대기 | 발행 + 예약 합계, 하위에 발행/예약 각각 |
| 수행 중 | 수행 중 건수 |
| 완료 | 완료 건수, 하위에 적시수행/지연수행 |
| 취소 | 취소 건수, 하위에 각 취소 유형 (0건인 유형은 숨김) |

### 4.6 인터랙션 매핑
| 클릭 요소 | goOrdersWithFilter 파라미터 |
|----------|---------------------------|
| 탭별 발행 | `{ status: "발행", orderType: [선택된탭.orderType] }` |
| 탭별 예약 | `{ status: "예약", orderType: [선택된탭.orderType] }` |
| 탭별 수행 중 | `{ status: "수행 중", orderType: [선택된탭.orderType] }` |
| 탭별 완료 | `{ status: "완료", orderType: [선택된탭.orderType] }` |
| 탭별 취소 | `{ status: "취소", orderType: [선택된탭.orderType] }` |
| 탭별 취소 유형 | `{ status: "취소", orderType: [선택된탭.orderType], cancelType: [취소유형] }` |

---

## 5. [영역 3] 파트너 수행 관리

### 5.1 개요
파트너별 오더 현황 및 성과 지표를 테이블로 표시하여 파트너 관리 지원

### 5.2 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│  파트너 수행 관리                                            │
│  파트너별 오더 현황 및 성과 지표                              │
├─────────────────────────────────────────────────────────────┤
│  파트너 │ 담당 │ 대기 │ 수행중 │ 적시율 │ 리스크 │ 리드타임 │ 지연 │
├─────────────────────────────────────────────────────────────┤
│  A파트너│  25  │  3   │   2   │  92%  │   2   │  5.2일  │  1  │
│  B파트너│  20  │  5   │   1   │  85%  │   3   │  8.5일  │  2  │
│  ...    │ ...  │ ...  │  ...  │  ...  │  ...  │   ...   │ ... │
└─────────────────────────────────────────────────────────────┘
```

### 5.3 테이블 컬럼 정의

| 컬럼 | 설명 | 집계 방식 |
|------|------|----------|
| 파트너 | 파트너사 명 | - |
| 담당 | 해당 파트너의 전체 오더 수 | count |
| 대기 | 발행 + 예약 상태 오더 수 | status in (발행, 예약) |
| 수행중 | 수행 중 상태 오더 수 | status = 수행 중 |
| 적시율 | 완료 오더 중 적시수행 비율 | (적시수행 / (적시수행 + 지연수행)) × 100 |
| 리스크 | 리스크 오더 수 (위생장애, ML긴급, 초장기미세차) | orderType in (위생장애, 고객 피드백(ML)_긴급, 초장기 미세차) |
| 리드타임 | 리스크 오더의 평균 리드 타임 | avg(현재 - rootCreatedAt) |
| 지연 | 수행 중이면서 지연된 오더 수 | status = 수행 중 AND elapsedDays > 7 |

### 5.4 경고 표시 로직

| 지표 | 경고 기준 | 색상 |
|------|----------|------|
| 대기 | ≥ 7: 주의 (노랑), ≥ 10: 위험 (빨강) | #E8C47C / #D98E8E |
| 적시율 | < 85%: 주의 (노랑), < 80%: 위험 (빨강) | #E8C47C / #D98E8E |
| 리스크 | ≥ 3: 주의 (노랑), ≥ 5: 위험 (빨강) | #E8C47C / #D98E8E |
| 리드타임 | ≥ 7일: 주의 (노랑), ≥ 10일: 위험 (빨강) | #E8C47C / #D98E8E |
| 지연 | ≥ 1: 주의 (노랑), ≥ 3: 위험 (빨강) | #E8C47C / #D98E8E |

경고 시 해당 수치 앞에 색상 원형 인디케이터 표시

### 5.5 인터랙션
| 클릭 요소 | goOrdersWithFilter 파라미터 |
|----------|---------------------------|
| 파트너명 | `{ partner: [파트너명] }` |
| 담당 | `{ partner: [파트너명] }` |
| 대기 | `{ partner: [파트너명], status: "발행" }` |
| 수행중 | `{ partner: [파트너명], status: "수행 중" }` |
| 적시율 | `{ partner: [파트너명], status: "완료" }` |
| 리스크 | `{ partner: [파트너명], orderType: "위생장애" }` |
| 리드타임 | `{ partner: [파트너명], orderType: "위생장애" }` |
| 지연 | `{ partner: [파트너명], status: "수행 중" }` |

### 5.6 정렬
- 기본 정렬: 담당 오더 수 기준 내림차순

---

## 6. [영역 4] 시계열 트렌드 그래프

### 6.1 개요
시간 흐름에 따른 오더 및 리스크 추이를 시각화하여 이상 징후 조기 감지

### 6.2 레이아웃
```
┌─────────────────────────────────┬─────────────────────────────────┐
│                                 │                                 │
│  [A] 일자별 정규 오더 생성량     │  [B] 일별 리스크 유형별 추이     │
│      (막대 그래프)              │      (라인 차트)                │
│                                 │                                 │
└─────────────────────────────────┴─────────────────────────────────┘
```

### 6.3 그래프 A: 일자별 정규 오더 생성량

#### 6.3.1 목적
정규 오더의 일별 생성 추이 파악

#### 6.3.2 차트 유형
막대 그래프 (Bar Chart)

#### 6.3.3 데이터 필드
| 필드명 | 설명 | 데이터 타입 |
|--------|------|------------|
| date | 날짜 (YYYY-MM-DD) | String |
| dateLabel | 표시용 날짜 (MM/DD) | String |
| count | 정규 오더 생성 수 | Integer |

#### 6.3.4 시각화 요소
| 요소 | 설명 |
|------|------|
| X축 | 날짜 (MM/DD 형식, 최근 7일) |
| Y축 | 오더 생성 건수 |
| 막대 색상 | rgba(123, 163, 201, 0.8) |
| 막대 모서리 | 상단만 둥글게 (radius: [4, 4, 0, 0]) |
| 최대 너비 | 40px |

#### 6.3.5 인터랙션
| 요소 | 동작 |
|------|------|
| 막대 호버 | 툴팁: 날짜, 정규 오더 N건 |

### 6.4 그래프 B: 일별 리스크 유형별 추이

#### 6.4.1 목적
리스크 유형별 건수 추이를 파악하여 증가 패턴 조기 감지

#### 6.4.2 차트 유형
직선 라인 차트 (Line Chart, type="linear")

#### 6.4.3 데이터 필드
| 필드명 | 설명 | 데이터 타입 |
|--------|------|------------|
| date | 날짜 (MM-DD 형식) | String |
| hygiene | 위생장애 건수 | Integer |
| ml_urgent | 고객피드백(ML)_긴급 건수 | Integer |
| long_term | 초장기미세차 건수 | Integer |

#### 6.4.4 시각화 요소
| 요소 | 설명 |
|------|------|
| X축 | 날짜 (MM-DD 형식, 최근 7일) |
| Y축 | 리스크 오더 건수 |
| 라인 1 | 위생장애 - rgba(217, 142, 142, 0.8), strokeWidth: 2 |
| 라인 2 | ML긴급 - rgba(232, 196, 124, 0.8), strokeWidth: 2 |
| 라인 3 | 초장기미세차 - rgba(123, 163, 201, 0.8), strokeWidth: 2 |
| 포인트 | dot: r=4, 각 라인 색상과 동일 |
| 호버 포인트 | activeDot: r=6, 100% 색상으로 강조 |

#### 6.4.5 범례
- 위치: 차트 상단 우측
- 아이콘: 원형 (iconType="circle")
- 표시: 위생장애, ML긴급, 초장기미세차

#### 6.4.6 인터랙션
| 요소 | 동작 |
|------|------|
| 라인 포인트 호버 | 툴팁: 날짜, 각 유형별 N건 (스타일: 둥근 모서리, 그림자) |
| 범례 클릭 | 해당 유형 표시/숨김 토글 |

---

## 7. API 명세 (Mock Data)

### 7.1 대시보드 전체 데이터 (dashboard.json)

```json
{
  "updated_at": "2026-02-04T10:00:00Z",
  "order_status": {
    "total": 103,
    "issued": 12,
    "reserved": 16,
    "in_progress": 12,
    "cancelled": {
      "total": 11,
      "change": 3,
      "no_reservation": 4,
      "no_show": 2,
      "agent": 1,
      "rain": 1
    },
    "completed": {
      "total": 52,
      "on_time": 8,
      "delayed": 44
    }
  },
  "risk_management": {
    "hygiene": {
      "total": 3,
      "issued": 0,
      "reserved": 1,
      "in_progress": 0,
      "cancelled": { "total": 1, "change": 0, "no_reservation": 0, "no_show": 0, "agent": 1, "rain": 0 },
      "completed": { "total": 1, "on_time": 0, "delayed": 1 }
    },
    "ml_urgent": {
      "total": 5,
      "issued": 1,
      "reserved": 1,
      "in_progress": 2,
      "cancelled": { "total": 0, "change": 0, "no_reservation": 0, "no_show": 0, "agent": 0, "rain": 0 },
      "completed": { "total": 1, "on_time": 0, "delayed": 1 }
    },
    "long_term": {
      "total": 4,
      "issued": 0,
      "reserved": 0,
      "in_progress": 0,
      "cancelled": { "total": 2, "change": 1, "no_reservation": 0, "no_show": 1, "agent": 0, "rain": 0 },
      "completed": { "total": 2, "on_time": 0, "delayed": 2 }
    }
  },
  "daily_risks": {
    "period": { "start": "2026-01-29", "end": "2026-02-04" },
    "data": [
      { "date": "2026-01-29", "hygiene": 2, "ml_urgent": 3, "long_term": 5 },
      { "date": "2026-01-30", "hygiene": 1, "ml_urgent": 4, "long_term": 4 },
      { "date": "2026-01-31", "hygiene": 3, "ml_urgent": 2, "long_term": 6 },
      { "date": "2026-02-01", "hygiene": 2, "ml_urgent": 5, "long_term": 3 },
      { "date": "2026-02-02", "hygiene": 1, "ml_urgent": 3, "long_term": 4 },
      { "date": "2026-02-03", "hygiene": 2, "ml_urgent": 4, "long_term": 5 },
      { "date": "2026-02-04", "hygiene": 3, "ml_urgent": 5, "long_term": 4 }
    ]
  },
  "daily_regular_orders": {
    "period": { "start": "2026-01-29", "end": "2026-02-04" },
    "data": [
      { "date": "2026-01-29", "count": 12 },
      { "date": "2026-01-30", "count": 15 },
      { "date": "2026-01-31", "count": 18 },
      { "date": "2026-02-01", "count": 14 },
      { "date": "2026-02-02", "count": 20 },
      { "date": "2026-02-03", "count": 16 },
      { "date": "2026-02-04", "count": 22 }
    ]
  }
}
```

---

## 8. 용어 정의

| 용어 | 정의 |
|------|------|
| 오더 | 세차 서비스 요청 건 |
| 발행 | 오더가 생성(발행)되었으나 아직 예약이 완료되지 않은 상태 |
| 예약 | 파트너사 승인 완료 후 예약이 확정된 상태 |
| 수행 중 | 에이전트가 세차를 진행 중인 상태 |
| 수행 완료 | 세차가 완료된 상태 |
| 적시수행 | 예정된 시간 내에 완료된 수행 (elapsedDays ≤ 7) |
| 지연수행 | 예정된 시간을 초과하여 완료된 수행 (elapsedDays > 7) |
| 위생장애 | 위생 관련 이슈가 발생한 오더 |
| 고객피드백(ML)_긴급 | ML 모델이 긴급으로 분류한 고객 피드백이 있는 오더 |
| 초장기미세차 | 장기간 세차가 이루어지지 않은 차량의 오더 |
| 리드타임 | 오더 최초 발행(rootCreatedAt)부터 현재까지의 경과 시간 |

---

## 9. 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2025-02-04 | ASTI | 최초 작성 |
| 2.0 | 2026-02-04 | Claude | 현재 구현에 맞게 전면 개정 |
| | | | - 영역 구조 변경 (파트너 수행 관리 영역 추가) |
| | | | - 오더 현황: Funnel → 도넛 차트 + 카드 방식 |
| | | | - 도넛 차트 5개 상태 → 4개 상태 (수행 대기, 수행 중, 완료, 취소) |
| | | | - 리스크 도넛 차트에서 일반 오더 제외 |
| | | | - 시계열 그래프 A: 시간대별 → 일자별 정규 오더 막대 그래프 |
| | | | - 시계열 그래프 B: 영역 차트 → 직선 라인 차트 |
| | | | - 색상 팔레트: 쿨 톤 + 80% 투명도 적용 |
| | | | - API 응답에 daily_regular_orders 추가 |
